<template>
  <div ref="preview" class="css-preview">
    <svg xmlns="http://www.w3.org/2000/svg" width="257" height="40" viewBox="0 0 257 71" fill="none">
      <path
        d="M256.414 57.4142C257.195 56.6332 257.195 55.3668 256.414 54.5858L243.686 41.8579C242.905 41.0768 241.639 41.0768 240.858 41.8579C240.077 42.6389 240.077 43.9052 240.858 44.6863L252.172 56L240.858 67.3137C240.077 68.0948 240.077 69.3611 240.858 70.1421C241.639 70.9232 242.905 70.9232 243.686 70.1421L256.414 57.4142ZM0 56V58H255V56V54H0V56Z"
        fill="white" />
      <path
        d="M77.904 25.416C75.952 25.416 74.208 25.8 72.672 26.568C71.136 27.304 70.032 28.376 69.36 29.784V45H62.928V19.848H68.832V25.224C69.728 23.496 70.864 22.136 72.24 21.144C73.616 20.152 75.072 19.608 76.608 19.512C76.96 19.512 77.232 19.512 77.424 19.512C77.616 19.512 77.776 19.528 77.904 19.56V25.416ZM92.8264 45.48C90.8104 45.48 88.9864 45.144 87.3544 44.472C85.7224 43.768 84.3304 42.824 83.1784 41.64C82.0264 40.424 81.1304 39.048 80.4904 37.512C79.8824 35.944 79.5784 34.296 79.5784 32.568C79.5784 30.168 80.1064 27.976 81.1624 25.992C82.2504 24.008 83.7864 22.424 85.7704 21.24C87.7864 20.024 90.1544 19.416 92.8744 19.416C95.6264 19.416 97.9784 20.024 99.9304 21.24C101.882 22.424 103.37 24.008 104.394 25.992C105.45 27.944 105.978 30.056 105.978 32.328C105.978 32.712 105.962 33.112 105.93 33.528C105.898 33.912 105.866 34.232 105.834 34.488H86.3944C86.5224 35.768 86.8904 36.888 87.4984 37.848C88.1384 38.808 88.9384 39.544 89.8984 40.056C90.8904 40.536 91.9464 40.776 93.0664 40.776C94.3464 40.776 95.5464 40.472 96.6664 39.864C97.8184 39.224 98.6024 38.392 99.0184 37.368L104.538 38.904C103.93 40.184 103.05 41.32 101.898 42.312C100.778 43.304 99.4504 44.088 97.9144 44.664C96.3784 45.208 94.6824 45.48 92.8264 45.48ZM86.2504 30.408H99.4024C99.2744 29.128 98.9064 28.024 98.2984 27.096C97.7224 26.136 96.9544 25.4 95.9944 24.888C95.0344 24.344 93.9624 24.072 92.7784 24.072C91.6264 24.072 90.5704 24.344 89.6104 24.888C88.6824 25.4 87.9144 26.136 87.3064 27.096C86.7304 28.024 86.3784 29.128 86.2504 30.408ZM119.161 45.48C117.017 45.48 114.969 45.128 113.017 44.424C111.065 43.72 109.385 42.68 107.977 41.304L110.281 37.128C111.785 38.344 113.257 39.24 114.697 39.816C116.169 40.392 117.577 40.68 118.921 40.68C120.169 40.68 121.161 40.456 121.897 40.008C122.665 39.56 123.049 38.888 123.049 37.992C123.049 37.384 122.841 36.92 122.425 36.6C122.009 36.248 121.401 35.944 120.601 35.688C119.833 35.432 118.889 35.144 117.769 34.824C115.913 34.216 114.361 33.624 113.113 33.048C111.865 32.472 110.921 31.752 110.281 30.888C109.673 29.992 109.369 28.856 109.369 27.48C109.369 25.816 109.785 24.392 110.617 23.208C111.481 21.992 112.665 21.048 114.169 20.376C115.705 19.704 117.497 19.368 119.545 19.368C121.337 19.368 123.033 19.656 124.633 20.232C126.233 20.776 127.689 21.672 129.001 22.92L126.409 27C125.129 26.008 123.913 25.288 122.761 24.84C121.609 24.36 120.441 24.12 119.257 24.12C118.585 24.12 117.945 24.2 117.337 24.36C116.761 24.52 116.281 24.792 115.897 25.176C115.545 25.528 115.369 26.04 115.369 26.712C115.369 27.32 115.529 27.8 115.849 28.152C116.201 28.472 116.713 28.76 117.385 29.016C118.089 29.272 118.937 29.56 119.929 29.88C121.945 30.456 123.641 31.048 125.017 31.656C126.425 32.264 127.481 33.016 128.185 33.912C128.889 34.776 129.241 35.976 129.241 37.512C129.241 40.008 128.329 41.96 126.505 43.368C124.681 44.776 122.233 45.48 119.161 45.48ZM133.616 45V19.848H140.048V45H133.616ZM133.616 16.344V9.96H140.048V16.344H133.616ZM144.17 41.064L158.042 24.36H144.746V19.848H164.954V23.784L151.178 40.488H165.194V45H144.17V41.064ZM180.764 45.48C178.748 45.48 176.924 45.144 175.292 44.472C173.66 43.768 172.268 42.824 171.116 41.64C169.964 40.424 169.068 39.048 168.428 37.512C167.82 35.944 167.516 34.296 167.516 32.568C167.516 30.168 168.044 27.976 169.1 25.992C170.188 24.008 171.724 22.424 173.708 21.24C175.724 20.024 178.092 19.416 180.812 19.416C183.564 19.416 185.916 20.024 187.868 21.24C189.82 22.424 191.308 24.008 192.332 25.992C193.388 27.944 193.916 30.056 193.916 32.328C193.916 32.712 193.9 33.112 193.868 33.528C193.836 33.912 193.804 34.232 193.772 34.488H174.332C174.46 35.768 174.828 36.888 175.436 37.848C176.076 38.808 176.876 39.544 177.836 40.056C178.828 40.536 179.884 40.776 181.004 40.776C182.284 40.776 183.484 40.472 184.604 39.864C185.756 39.224 186.54 38.392 186.956 37.368L192.476 38.904C191.868 40.184 190.988 41.32 189.836 42.312C188.716 43.304 187.388 44.088 185.852 44.664C184.316 45.208 182.62 45.48 180.764 45.48ZM174.188 30.408H187.34C187.212 29.128 186.844 28.024 186.236 27.096C185.66 26.136 184.892 25.4 183.932 24.888C182.972 24.344 181.9 24.072 180.716 24.072C179.564 24.072 178.508 24.344 177.548 24.888C176.62 25.4 175.852 26.136 175.244 27.096C174.668 28.024 174.316 29.128 174.188 30.408Z"
        fill="white" />
    </svg>
    <slot />
  </div>
</template>

<script setup>
import { onMounted, ref } from 'vue';

const props = defineProps(['css'])

const preview = ref(null)
let scopedId = ""

onMounted(() => {
  const attributes = preview?.value?.attributes
  for (const attr of attributes) {
    if (attr.name.startsWith("data-v-")) {
      scopedId = attr.name
    }
  }

  const styleTag = document.createElement('style')
  styleTag.textContent = `[${scopedId}] { ${props.css} }`;
  document.head.appendChild(styleTag)
})
</script>

<style lang="css" scoped>
.css-preview {
  --bg: lch(10.63% 8.08 289.58);
  display: grid;
  place-items: center;
  color: var(--color-default-white);
  background-color: var(--bg);
  border-radius: var(--radius-default);
  min-height: 10rem;
  position: relative;
  overflow-x: auto;
  resize: horizontal;

  & svg {
    enable-background: new 0 0 128 128;
    position: absolute;
    bottom: 0px;
    right: 10px;
    fill: var(--color-accent);
    max-width: 64px;
  }
}
</style>
